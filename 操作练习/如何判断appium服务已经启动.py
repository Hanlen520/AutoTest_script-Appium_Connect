import os
import time
from multiprocessing import Process


def launch():
    print "launch start %s" % time.strftime("%Y-%m-%d %H:%M:%S")
    command = "appium -a 127.0.0.1 -p 4725 -bp 4726 -U  1234556  --no-reset"
    os.system(command)
    print "launch end %s" % time.strftime("%Y-%m-%d %H:%M:%S")


if __name__ == "__main__":
    a = Process(target=launch)
    a.start()
    while True:
        command = "netstat -aon|findstr 4725"
        print "4725", os.popen(command).read(), time.strftime("%Y-%m-%d %H:%M:%S")
        command = "netstat -aon|findstr 4726"
        print "4726", os.popen(command).read(), time.strftime("%Y-%m-%d %H:%M:%S")

        # output:
        # 725  2017-04-25 11:21:40
        # 4726launch start 2017-04-25 11:21:40
        #   2017-04-25 11:21:40
        # 4725  2017-04-25 11:21:41
        # 4726  2017-04-25 11:21:41
        # 4725  2017-04-25 11:21:41
        # 4726  2017-04-25 11:21:41
        # 4725  2017-04-25 11:21:41
        # 4726  2017-04-25 11:21:41
        # 4725  2017-04-25 11:21:42
        # 4726  2017-04-25 11:21:42
        # 4725  2017-04-25 11:21:42
        # 4726  2017-04-25 11:21:42
        # 4725  2017-04-25 11:21:42
        # 4726  2017-04-25 11:21:43
        # 4725  2017-04-25 11:21:43
        # 4726  2017-04-25 11:21:43
        # 4725  2017-04-25 11:21:43
        # 4726  2017-04-25 11:21:43
        # 4725  2017-04-25 11:21:43
        # 4726  2017-04-25 11:21:44
        # 4725  2017-04-25 11:21:44
        # 4726  2017-04-25 11:21:44
        # 4725  2017-04-25 11:21:44
        # 4726  2017-04-25 11:21:44
        # 4725  2017-04-25 11:21:44
        # 4726  2017-04-25 11:21:44
        # 4725  2017-04-25 11:21:44
        # 4726  2017-04-25 11:21:45
        # 4725  2017-04-25 11:21:45
        # 4726  2017-04-25 11:21:45
        # 4725  2017-04-25 11:21:46
        # 4726  2017-04-25 11:21:46
        # 4725  2017-04-25 11:21:46
        # 4726  2017-04-25 11:21:47
        # 4725  2017-04-25 11:21:47
        # 4726  2017-04-25 11:21:47
        # 4725  2017-04-25 11:21:47
        # 4726  2017-04-25 11:21:47
        # 4725  2017-04-25 11:21:47
        # 4726  2017-04-25 11:21:47
        # 4725  2017-04-25 11:21:47
        # 4726  2017-04-25 11:21:47
        # 4725  2017-04-25 11:21:48
        # 4726  2017-04-25 11:21:48
        # 4725  2017-04-25 11:21:48
        # 4726  2017-04-25 11:21:48
        # 4725  2017-04-25 11:21:48
        # 4726  2017-04-25 11:21:48
        # 4725  2017-04-25 11:21:48
        # 4726  2017-04-25 11:21:49
        # 4725info: Welcome to Appium v1.4.16 (REV ae6877eff263066b26328d457bd285c0cc62430d)
        # info: Appium REST http interface listener started on 127.0.0.1:4725
        #   2017-04-25 11:21:49
        # 4726info: [debug] Non-default server args: {"udid":"1234556","address":"127.0.0.1","port":4725,"bootstrapPort":4726,"noReset":true}
        # info: Console LogLevel: debug
        #   2017-04-25 11:21:49
        # 4725   TCP    127.0.0.1:4725         0.0.0.0:0              LISTENING       560
        # 2017-04-25 11:21:49
        # 4726  2017-04-25 11:21:49
        # 4725   TCP    127.0.0.1:4725         0.0.0.0:0              LISTENING       560
        # 2017-04-25 11:21:49
        # 4726  2017-04-25 11:21:49
        # 4725   TCP    127.0.0.1:4725         0.0.0.0:0              LISTENING       560
        # 2017-04-25 11:21:49
        # 4726  2017-04-25 11:21:50
        # 4725   TCP    127.0.0.1:4725         0.0.0.0:0              LISTENING       560
        # 2017-04-25 11:21:50
        # 4726  2017-04-25 11:21:50
        # 4725   TCP    127.0.0.1:4725         0.0.0.0:0              LISTENING       560
        # 2017-04-25 11:21:50
        # 4726  2017-04-25 11:21:50
        # 4725   TCP    127.0.0.1:4725         0.0.0.0:0              LISTENING       560
        # 2017-04-25 11:21:50
        # 4726  2017-04-25 11:21:50
        # 4725   TCP    127.0.0.1:4725         0.0.0.0:0              LISTENING       560
        # 2017-04-25 11:21:50
